@page "/games/{gameId:guid}"
@using TheCodeKitchen.Presentation.ManagementUI.Components.Reusable

<PageTitle>Game</PageTitle>

@if (!string.IsNullOrWhiteSpace(GameErrorMessage))
{
    <MudAlert Severity="Severity.Error">@GameErrorMessage</MudAlert>
}
else if (GetGameResponse is null)
{
    <MudProgressCircular Color="Color.Primary" Indeterminate="true"/>
}
else
{
    <MudText Typo="Typo.h3" Class="mb-3">@GetGameResponse.Name</MudText>

    if (GetGameResponse.Started is null)
    {
        <MudAlert Severity="Severity.Info">The game has not yet started.</MudAlert>
    }

    <MudButton OnClick="@PauseOrUnpauseGame"
               Variant="Variant.Filled"
               Color="Color.Primary"
               Disabled="@(Paused is null || GetGameResponse.Started is null || Busy)"
               Class="mb-3">
        @if (Paused == true)
        {
            <MudIcon Icon="@Icons.Material.Filled.PlayArrow"/>
            <span>Play</span>
        }
        else
        {
            <MudIcon Icon="@Icons.Material.Filled.Pause"/>
            <span>Pause</span>
        }
    </MudButton>
    <MudButton OnClick="@NextMoment"
               Variant="Variant.Filled"
               Color="Color.Primary"
               Disabled="@(Paused == false || GetGameResponse.Started is null || Busy)"
               Class="mb-3">
        <MudIcon Icon="@Icons.Material.Filled.NextPlan"/>
        Advance
    </MudButton>

    if (!string.IsNullOrWhiteSpace(KitchenErrorMessage))
    {
        <MudAlert Severity="Severity.Error">@KitchenErrorMessage</MudAlert>
    }
    else if (Kitchens is null)
    {
        <MudProgressCircular Color="Color.Primary" Indeterminate="true"/>
    }
    else
    {
        <MudGrid Spacing="1">
            @foreach (var kitchen in Kitchens)
            {
                <MudItem xs="12" md="6" xl="4">
                    <KitchenView Kitchen="@kitchen"/>
                </MudItem>
            }
        </MudGrid>
    }
}